
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kubernetesinmyhead.net/networking/services/traffic-policies/">
      
      
        <link rel="prev" href="../../metallb/98-tips/">
      
      
        <link rel="next" href="../../../observability/architecture/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Kubernetes Service Traffic Policies - Kubernetes in my head</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kubernetes-service-traffic-policies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Kubernetes in my head" class="md-header__button md-logo" aria-label="Kubernetes in my head" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kubernetes in my head
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kubernetes Service Traffic Policies
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Kubernetes in my head" class="md-nav__button md-logo" aria-label="Kubernetes in my head" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kubernetes in my head
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kubernetesinmyhead.net
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../CI-CD/argo-events/filtering/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    CI CD
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../database/cloudnative-pg/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Database
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../deployment/resource-templating/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../git/detached-head/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../gitops/get-raw-yaml/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Gitops
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../k8s-resource-handling/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    K8s resource handling
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../kubernetes/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../languages/comment-comment-out/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Languages
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../misc/android/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Networking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering-with-nodeport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Good/Bad news filtering in NSX-T/Nodeport
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kube-proxy-ipvs-to-nftables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrating kube-proxy from IPVS to nftables in kubeadm clusters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network-policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onpremise-loadbalancers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    On premise load balancers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../aws-load-balancer-controller/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Aws load balancer controller
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../cilium/99-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Cilium
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../contour/deployment/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Contour
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../gateway-api/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Gateway api
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../metallb/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Metallb
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_10" checked>
        
          
          <label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Service Traffic Policies
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Service Traffic Policies
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Index">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Index
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#externaltrafficpolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="externalTrafficPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-cluster-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Cluster (Default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-local" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Local
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internaltrafficpolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="internalTrafficPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicy-cluster-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy Cluster (Default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicylocal" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicyLocal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-cluster-access-to-external-ip" class="md-nav__link">
    <span class="md-ellipsis">
      
        Internal Cluster Access to External IP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-balancer-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load Balancer Responsibilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load Balancer Responsibilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cluster Mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Local Mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicy-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy Selection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      
        Links
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../observability/architecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../operating-systems/too-many-open-files/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Operating systems
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    
  
  
  
    <a href="../../../platforms/aws/cli/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../queues/nats/99-links/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Queues
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../security/cert-manager/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../services/external-dns/98-tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../storage/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../tools/Buildkit/output/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../vibe-sreing/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Vibe sreing
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Index">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Index
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#externaltrafficpolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="externalTrafficPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-cluster-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Cluster (Default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-local" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Local
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internaltrafficpolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="internalTrafficPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicy-cluster-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy Cluster (Default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicylocal" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicyLocal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-cluster-access-to-external-ip" class="md-nav__link">
    <span class="md-ellipsis">
      
        Internal Cluster Access to External IP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-balancer-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load Balancer Responsibilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load Balancer Responsibilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cluster Mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Local Mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#externaltrafficpolicy-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        externalTrafficPolicy Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internaltrafficpolicy-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        internalTrafficPolicy Selection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      
        Links
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    kubernetesinmyhead.net
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../filtering-with-nodeport/" class="md-path__link">
          
  <span class="md-ellipsis">
    Networking
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Services
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="kubernetes-service-traffic-policies">Kubernetes Service Traffic Policies<a class="headerlink" href="#kubernetes-service-traffic-policies" title="Anchor link to this section for reference">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Anchor link to this section for reference">&para;</a></h2>
<p>Traffic policies in Kubernetes Services control how traffic is routed to pods through kube-proxy. Understanding <code>externalTrafficPolicy</code> and <code>internalTrafficPolicy</code> is crucial when using LoadBalancer or NodePort services, especially in on-premise environments.</p>
<h2 id="externaltrafficpolicy">externalTrafficPolicy<a class="headerlink" href="#externaltrafficpolicy" title="Anchor link to this section for reference">&para;</a></h2>
<p>Describes how nodes distribute service traffic they receive on <strong>externally-facing addresses (NodePorts, ExternalIPs, and LoadBalancer IPs)</strong>. This field does NOT apply to traffic from within the cluster destined to LoadBalancer or ExternalIPâ€”such traffic always uses <code>Cluster</code> semantics.</p>
<h3 id="externaltrafficpolicy-cluster-default">externalTrafficPolicy Cluster (Default)<a class="headerlink" href="#externaltrafficpolicy-cluster-default" title="Anchor link to this section for reference">&para;</a></h3>
<p>With externalTrafficPolicy Cluster, kube-proxy sends the traffic to any pod in the cluster matched by the service.</p>
<blockquote>
<p>Here the client source IP is masqueraded (hidden)</p>
</blockquote>
<p><strong>Advantages:</strong></p>
<ul>
<li>Better load distribution across all pods</li>
<li>No traffic concentration on specific nodes</li>
<li>Works with any pod placement strategy</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Additional network hop (latency)</li>
<li>Client source IP is not preserved</li>
<li>Breaks internal pod-to-external-IP communication (pods cannot reach the service's external LoadBalancer IP)</li>
</ul>
<p><strong>Use case:</strong> External clients connecting to your service</p>
<h3 id="externaltrafficpolicy-local">externalTrafficPolicy Local<a class="headerlink" href="#externaltrafficpolicy-local" title="Anchor link to this section for reference">&para;</a></h3>
<p>Here the externalTrafficPolicy Local, each node delivers traffic only to node-local endpoints without masquerading the client source IP. Traffic mistakenly sent to a node with no endpoints is dropped (not forwarded).</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Node receives traffic and only proxies to pods on the same node</li>
<li>Client source IP is preserved</li>
<li>Assumes external load balancers will balance traffic between nodes</li>
<li>If a node has no local endpoints, traffic is dropped (not redirected)</li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li>Preserves client source IP (visible to pods)</li>
<li>Lower latency (no cross-node network hop)</li>
<li>Better performance (minimal proxying)</li>
<li>Internal pods CAN reach the service's external IP</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Uneven load distribution</li>
<li>Traffic concentrates on nodes where pods are running</li>
<li>Dropped traffic if receiving node has no local endpoints</li>
<li>Requires external load balancer intelligence</li>
<li>Doesn't work well with single-replica deployments on unscheduled nodes</li>
</ul>
<p><strong>Use case:</strong> On-premise environments, performance-critical services, source IP preservation, or with external load balancers that understand node topology</p>
<h2 id="internaltrafficpolicy">internalTrafficPolicy<a class="headerlink" href="#internaltrafficpolicy" title="Anchor link to this section for reference">&para;</a></h2>
<p>Describes how nodes distribute service traffic they receive <strong>on the ClusterIP</strong>. Controls pod-to-service communication within the cluster. Only applies to traffic destined to the ClusterIP; similar logic applies to NodePort access from within the cluster.</p>
<h3 id="internaltrafficpolicy-cluster-default">internalTrafficPolicy Cluster (Default)<a class="headerlink" href="#internaltrafficpolicy-cluster-default" title="Anchor link to this section for reference">&para;</a></h3>
<p>Routes internal traffic to all ready endpoints in the cluster evenly. Pods can reach any service endpoint regardless of node location.</p>
<h3 id="internaltrafficpolicylocal">internalTrafficPolicyLocal<a class="headerlink" href="#internaltrafficpolicylocal" title="Anchor link to this section for reference">&para;</a></h3>
<p>Routes traffic only to node-local endpoints. Reduces cross-node traffic and improves latency for latency-sensitive applications. Requires at least one endpoint per node for reliability. Works with ClusterIP, NodePort, and LoadBalancer services.</p>
<h2 id="internal-cluster-access-to-external-ip">Internal Cluster Access to External IP<a class="headerlink" href="#internal-cluster-access-to-external-ip" title="Anchor link to this section for reference">&para;</a></h2>
<p>When a pod calls an ExternalIP, the request doesn't actually travel out to the Physical Load Balancer and back in.</p>
<ul>
<li>The Linux networking stack (via kube-proxy) intercepts the packet as soon as it leaves the pod.</li>
<li>kube-proxy sees the destination is an ExternalIP that it "owns."</li>
<li>It immediately applies the routing rules defined by your externalTrafficPolicy right there on the source node.</li>
</ul>
<p><strong>With externalTrafficPolicy local if there are not pods in the same node where the call is done, the traffic is dropped</strong>. Solutions here can be using the internal service: <code>my-service.namespace.svc.cluster.local</code>, a daemonset or other mechanisms to ensure the pods doing the calls have endpoints it the same node</p>
<p>The behaviour tries to avoid</p>
<ul>
<li>routing loops: If the node sent the packet out to the Load Balancer, and the Load Balancer sent it right back to the same node (which can happen), you would create an infinite loop</li>
<li>hairpinning: Most Cloud Provider Load Balancers are not designed to handle "hairpin" traffic (traffic originating from one of its own targets and coming back to itself).</li>
</ul>
<h2 id="load-balancer-responsibilities">Load Balancer Responsibilities<a class="headerlink" href="#load-balancer-responsibilities" title="Anchor link to this section for reference">&para;</a></h2>
<h3 id="cluster-mode">Cluster Mode<a class="headerlink" href="#cluster-mode" title="Anchor link to this section for reference">&para;</a></h3>
<p><strong>What the load balancer must do:</strong></p>
<ul>
<li>Distribute traffic to ANY node in the cluster</li>
<li>Doesn't need to know which nodes have service endpoints</li>
<li>All traffic reaching any node is handled by kube-proxy and forwarded to correct endpoints</li>
</ul>
<p><strong>Best for:</strong> Cloud environments where load balancer has no visibility into cluster topology</p>
<h3 id="local-mode">Local Mode<a class="headerlink" href="#local-mode" title="Anchor link to this section for reference">&para;</a></h3>
<p><strong>What the load balancer must do:</strong></p>
<ul>
<li>Discover which nodes have endpoints for the service (via health checks or endpoint watcher)</li>
<li>Only send traffic to nodes that actually have service endpoints</li>
<li>Remove nodes from the load balancer pool if they have no endpoints</li>
<li>Monitor endpoint changes and update pool membership</li>
</ul>
<p><strong>Requirements:</strong></p>
<ul>
<li>Load balancer must support endpoint-aware routing</li>
<li>Requires integration with cluster (health check endpoint, endpoint discovery, or controller)</li>
</ul>
<p><strong>Load Balancer Support:</strong></p>
<ul>
<li><strong>MetalLB:</strong> Speaker daemon announces service endpoints via BGP/ARP</li>
<li><strong>AWS NLB:</strong></li>
<li><strong>Instance target type:</strong> Native support for <code>Local</code> via NodePort health checks</li>
<li><strong>IP target type:</strong> Direct pod routing; <code>Local</code> may not be effective (recommended: use <code>Cluster</code>)</li>
<li><strong>Azure LB:</strong> Integrated with AKS, automatic endpoint tracking per node</li>
<li><strong>GCP LB:</strong> Native support via Network Endpoint Groups (NEGs)</li>
<li><strong>F5/Citrix/HAProxy:</strong> Requires external controller integration</li>
</ul>
<p><strong>Best for:</strong> On-premise environments with sophisticated load balancers, or cloud providers with native integration</p>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Anchor link to this section for reference">&para;</a></h2>
<h3 id="externaltrafficpolicy-selection">externalTrafficPolicy Selection<a class="headerlink" href="#externaltrafficpolicy-selection" title="Anchor link to this section for reference">&para;</a></h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td>Public cloud (auto-scaling, many nodes)</td>
<td><code>Cluster</code></td>
</tr>
<tr>
<td>On-premise (fixed node topology)</td>
<td><code>Local</code></td>
</tr>
<tr>
<td>Internal pod-to-external-IP needed</td>
<td><code>Cluster</code></td>
</tr>
<tr>
<td>Source IP preservation critical</td>
<td><code>Local</code></td>
</tr>
<tr>
<td>Performance critical (lower latency)</td>
<td><code>Local</code></td>
</tr>
</tbody>
</table>
<h3 id="internaltrafficpolicy-selection">internalTrafficPolicy Selection<a class="headerlink" href="#internaltrafficpolicy-selection" title="Anchor link to this section for reference">&para;</a></h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard pod communication</td>
<td><code>Cluster</code> (default)</td>
</tr>
<tr>
<td>Reduce cross-node traffic</td>
<td><code>Local</code></td>
</tr>
<tr>
<td>Topology-aware routing desired</td>
<td>Consider <code>trafficDistribution: PreferClose</code></td>
</tr>
<tr>
<td>Zone-local deployments</td>
<td><code>Local</code> + multi-zone pods</td>
</tr>
</tbody>
</table>
<h2 id="links">Links<a class="headerlink" href="#links" title="Anchor link to this section for reference">&para;</a></h2>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#external-traffic-policy">Kubernetes Service - externalTrafficPolicy</a></li>
<li><a href="https://kubernetes.io/docs/concepts/services-networking/service/#internal-traffic-policy">Kubernetes Service - internalTrafficPolicy</a></li>
<li><a href="https://kubernetes.io/docs/reference/kubernetes-api/service-resources/service-v1/">Kubernetes Service API Reference</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../metallb/98-tips/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tips">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Tips
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../observability/architecture/" class="md-footer__link md-footer__link--next" aria-label="Next: Architecture">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Architecture
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://linkedin.com/in/jorge-p-275960300" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.path", "navigation.prune", "navigation.top", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>